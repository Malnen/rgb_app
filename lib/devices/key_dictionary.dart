import 'package:rgb_app/devices/keyboard_key.dart';
import 'package:rgb_app/enums/key_code.dart';

class KeyDictionary {
  static KeyboardKey esc = KeyboardKey(
    packetIndex: 0,
    index: 4,
    keyCode: KeyCode.esc,
  );
  static KeyboardKey backQuote = KeyboardKey(
    packetIndex: 0,
    index: 5,
    keyCode: KeyCode.backQuote,
  );
  static KeyboardKey tab = KeyboardKey(
    packetIndex: 0,
    index: 6,
    keyCode: KeyCode.tab,
  );
  static KeyboardKey capsLock = KeyboardKey(
    packetIndex: 0,
    index: 7,
    keyCode: KeyCode.capsLock,
  );
  static KeyboardKey leftShift = KeyboardKey(
    packetIndex: 0,
    index: 8,
    keyCode: KeyCode.leftShift,
  );
  static KeyboardKey leftControl = KeyboardKey(
    packetIndex: 0,
    index: 9,
    keyCode: KeyCode.leftControl,
  );
  static KeyboardKey f12 = KeyboardKey(
    packetIndex: 0,
    index: 10,
    keyCode: KeyCode.f12,
  );
  static KeyboardKey equal = KeyboardKey(
    packetIndex: 0,
    index: 11,
    keyCode: KeyCode.equal,
  );
  static KeyboardKey num7 = KeyboardKey(
    packetIndex: 0,
    index: 13,
    keyCode: KeyCode.numpad_7,
  );
  static KeyboardKey f1 = KeyboardKey(
    packetIndex: 0,
    index: 16,
    keyCode: KeyCode.f1,
  );
  static KeyboardKey key1 = KeyboardKey(
    packetIndex: 0,
    index: 17,
    keyCode: KeyCode.key1,
  );
  static KeyboardKey q = KeyboardKey(
    packetIndex: 0,
    index: 18,
    keyCode: KeyCode.q,
  );
  static KeyboardKey a = KeyboardKey(
    packetIndex: 0,
    index: 19,
    keyCode: KeyCode.a,
  );
  static KeyboardKey leftBackSlash = KeyboardKey(
    packetIndex: 0,
    index: 20,
    keyCode: KeyCode.leftBackSlash,
  );
  static KeyboardKey leftWin = KeyboardKey(
    packetIndex: 0,
    index: 21,
    keyCode: KeyCode.leftWin,
  );
  static KeyboardKey printScreen = KeyboardKey(
    packetIndex: 0,
    index: 22,
    keyCode: KeyCode.printScreen,
  );
  static KeyboardKey mute = KeyboardKey(
    packetIndex: 0,
    index: 24,
    keyCode: KeyCode.mute,
  );
  static KeyboardKey num8 = KeyboardKey(
    packetIndex: 0,
    index: 25,
    keyCode: KeyCode.numpad_8,
  );
  static KeyboardKey f2 = KeyboardKey(
    packetIndex: 0,
    index: 28,
    keyCode: KeyCode.f2,
  );
  static KeyboardKey key2 = KeyboardKey(
    packetIndex: 0,
    index: 29,
    keyCode: KeyCode.key2,
  );
  static KeyboardKey w = KeyboardKey(
    packetIndex: 0,
    index: 30,
    keyCode: KeyCode.w,
  );
  static KeyboardKey s = KeyboardKey(
    packetIndex: 0,
    index: 31,
    keyCode: KeyCode.s,
  );
  static KeyboardKey z = KeyboardKey(
    packetIndex: 0,
    index: 32,
    keyCode: KeyCode.z,
  );
  static KeyboardKey leftAlt = KeyboardKey(
    packetIndex: 0,
    index: 33,
    keyCode: KeyCode.leftAlt,
  );
  static KeyboardKey scrollLock = KeyboardKey(
    packetIndex: 0,
    index: 34,
    keyCode: KeyCode.scrollLock,
  );
  static KeyboardKey backSpace = KeyboardKey(
    packetIndex: 0,
    index: 35,
    keyCode: KeyCode.backSpace,
  );
  static KeyboardKey pause = KeyboardKey(
    packetIndex: 0,
    index: 36,
    keyCode: KeyCode.pause,
  );
  static KeyboardKey num9 = KeyboardKey(
    packetIndex: 0,
    index: 37,
    keyCode: KeyCode.numpad_9,
  );
  static KeyboardKey f3 = KeyboardKey(
    packetIndex: 0,
    index: 40,
    keyCode: KeyCode.f3,
  );
  static KeyboardKey key3 = KeyboardKey(
    packetIndex: 0,
    index: 41,
    keyCode: KeyCode.key3,
  );
  static KeyboardKey e = KeyboardKey(
    packetIndex: 0,
    index: 42,
    keyCode: KeyCode.e,
  );
  static KeyboardKey d = KeyboardKey(
    packetIndex: 0,
    index: 43,
    keyCode: KeyCode.d,
  );
  static KeyboardKey x = KeyboardKey(
    packetIndex: 0,
    index: 44,
    keyCode: KeyCode.x,
  );
  static KeyboardKey pauseBreak = KeyboardKey(
    packetIndex: 0,
    index: 46,
    keyCode: KeyCode.pauseBreak,
  );
  static KeyboardKey delete = KeyboardKey(
    packetIndex: 0,
    index: 47,
    keyCode: KeyCode.delete,
  );
  static KeyboardKey previous = KeyboardKey(
    packetIndex: 0,
    index: 48,
    keyCode: KeyCode.previous,
  );
  static KeyboardKey f4 = KeyboardKey(
    packetIndex: 0,
    index: 52,
    keyCode: KeyCode.f4,
  );
  static KeyboardKey key4 = KeyboardKey(
    packetIndex: 0,
    index: 53,
    keyCode: KeyCode.key4,
  );
  static KeyboardKey r = KeyboardKey(
    packetIndex: 0,
    index: 54,
    keyCode: KeyCode.r,
  );
  static KeyboardKey f = KeyboardKey(
    packetIndex: 0,
    index: 55,
    keyCode: KeyCode.f,
  );
  static KeyboardKey c = KeyboardKey(
    packetIndex: 0,
    index: 56,
    keyCode: KeyCode.c,
  );
  static KeyboardKey space = KeyboardKey(
    packetIndex: 0,
    index: 57,
    keyCode: KeyCode.spacebar,
  );
  static KeyboardKey insert = KeyboardKey(
    packetIndex: 0,
    index: 58,
    keyCode: KeyCode.insert,
  );
  static KeyboardKey end = KeyboardKey(
    packetIndex: 0,
    index: 59,
    keyCode: KeyCode.end,
  );
  static KeyboardKey resumeStop = KeyboardKey(
    packetIndex: 0,
    index: 60,
    keyCode: KeyCode.resumeStop,
  );
  static KeyboardKey num4 = KeyboardKey(
    packetIndex: 0,
    index: 61,
    keyCode: KeyCode.numpad_4,
  );
  static KeyboardKey f5 = KeyboardKey(
    packetIndex: 1,
    index: 4,
    keyCode: KeyCode.f5,
  );
  static KeyboardKey key5 = KeyboardKey(
    packetIndex: 1,
    index: 5,
    keyCode: KeyCode.key5,
  );
  static KeyboardKey t = KeyboardKey(
    packetIndex: 1,
    index: 6,
    keyCode: KeyCode.t,
  );
  static KeyboardKey g = KeyboardKey(
    packetIndex: 1,
    index: 7,
    keyCode: KeyCode.g,
  );
  static KeyboardKey v = KeyboardKey(
    packetIndex: 1,
    index: 8,
    keyCode: KeyCode.v,
  );
  static KeyboardKey home = KeyboardKey(
    packetIndex: 1,
    index: 10,
    keyCode: KeyCode.home,
  );
  static KeyboardKey pageDown = KeyboardKey(
    packetIndex: 1,
    index: 11,
    keyCode: KeyCode.pageDown,
  );
  static KeyboardKey next = KeyboardKey(
    packetIndex: 1,
    index: 12,
    keyCode: KeyCode.next,
  );
  static KeyboardKey num5 = KeyboardKey(
    packetIndex: 1,
    index: 13,
    keyCode: KeyCode.numpad_5,
  );
  static KeyboardKey f6 = KeyboardKey(
    packetIndex: 1,
    index: 16,
    keyCode: KeyCode.f6,
  );
  static KeyboardKey key6 = KeyboardKey(
    packetIndex: 1,
    index: 17,
    keyCode: KeyCode.key6,
  );
  static KeyboardKey y = KeyboardKey(
    packetIndex: 1,
    index: 18,
    keyCode: KeyCode.y,
  );
  static KeyboardKey h = KeyboardKey(
    packetIndex: 1,
    index: 19,
    keyCode: KeyCode.h,
  );
  static KeyboardKey b = KeyboardKey(
    packetIndex: 1,
    index: 20,
    keyCode: KeyCode.b,
  );
  static KeyboardKey pageUp = KeyboardKey(
    packetIndex: 1,
    index: 22,
    keyCode: KeyCode.pageUp,
  );
  static KeyboardKey rightShift = KeyboardKey(
    packetIndex: 1,
    index: 23,
    keyCode: KeyCode.rightShift,
  );
  static KeyboardKey numLock = KeyboardKey(
    packetIndex: 1,
    index: 24,
    keyCode: KeyCode.numLock,
  );
  static KeyboardKey num6 = KeyboardKey(
    packetIndex: 1,
    index: 25,
    keyCode: KeyCode.numpad_6,
  );
  static KeyboardKey f7 = KeyboardKey(
    packetIndex: 1,
    index: 28,
    keyCode: KeyCode.f7,
  );
  static KeyboardKey key7 = KeyboardKey(
    packetIndex: 1,
    index: 29,
    keyCode: KeyCode.key7,
  );
  static KeyboardKey u = KeyboardKey(
    packetIndex: 1,
    index: 30,
    keyCode: KeyCode.u,
  );
  static KeyboardKey j = KeyboardKey(
    packetIndex: 1,
    index: 31,
    keyCode: KeyCode.j,
  );
  static KeyboardKey n = KeyboardKey(
    packetIndex: 1,
    index: 32,
    keyCode: KeyCode.n,
  );
  static KeyboardKey rightAlt = KeyboardKey(
    packetIndex: 1,
    index: 33,
    keyCode: KeyCode.rightAlt,
  );
  static KeyboardKey closeBracket = KeyboardKey(
    packetIndex: 1,
    index: 34,
    keyCode: KeyCode.closeBracket,
  );
  static KeyboardKey rightControl = KeyboardKey(
    packetIndex: 1,
    index: 35,
    keyCode: KeyCode.rightControl,
  );
  static KeyboardKey divide = KeyboardKey(
    packetIndex: 1,
    index: 36,
    keyCode: KeyCode.divide,
  );
  static KeyboardKey num1 = KeyboardKey(
    packetIndex: 1,
    index: 37,
    keyCode: KeyCode.numpad_1,
  );
  static KeyboardKey f8 = KeyboardKey(
    packetIndex: 1,
    index: 40,
    keyCode: KeyCode.f8,
  );
  static KeyboardKey key8 = KeyboardKey(
    packetIndex: 1,
    index: 41,
    keyCode: KeyCode.key8,
  );
  static KeyboardKey i = KeyboardKey(
    packetIndex: 1,
    index: 42,
    keyCode: KeyCode.i,
  );
  static KeyboardKey k = KeyboardKey(
    packetIndex: 1,
    index: 43,
    keyCode: KeyCode.k,
  );
  static KeyboardKey m = KeyboardKey(
    packetIndex: 1,
    index: 44,
    keyCode: KeyCode.m,
  );
  static KeyboardKey rightWin = KeyboardKey(
    packetIndex: 1,
    index: 45,
    keyCode: KeyCode.rightWin,
  );
  static KeyboardKey upArrow = KeyboardKey(
    packetIndex: 1,
    index: 47,
    keyCode: KeyCode.upArrow,
  );
  static KeyboardKey multiply = KeyboardKey(
    packetIndex: 1,
    index: 48,
    keyCode: KeyCode.multiply,
  );
  static KeyboardKey num2 = KeyboardKey(
    packetIndex: 1,
    index: 49,
    keyCode: KeyCode.numpad_2,
  );
  static KeyboardKey f9 = KeyboardKey(
    packetIndex: 1,
    index: 52,
    keyCode: KeyCode.f9,
  );
  static KeyboardKey key9 = KeyboardKey(
    packetIndex: 1,
    index: 53,
    keyCode: KeyCode.key9,
  );
  static KeyboardKey o = KeyboardKey(
    packetIndex: 1,
    index: 54,
    keyCode: KeyCode.o,
  );
  static KeyboardKey l = KeyboardKey(
    packetIndex: 1,
    index: 55,
    keyCode: KeyCode.l,
  );
  static KeyboardKey comma = KeyboardKey(
    packetIndex: 1,
    index: 56,
    keyCode: KeyCode.comma,
  );
  static KeyboardKey contextMenu = KeyboardKey(
    packetIndex: 1,
    index: 57,
    keyCode: KeyCode.contextMenu,
  );
  static KeyboardKey backSlash = KeyboardKey(
    packetIndex: 1,
    index: 58,
    keyCode: KeyCode.backSlash,
  );
  static KeyboardKey leftArrow = KeyboardKey(
    packetIndex: 1,
    index: 59,
    keyCode: KeyCode.leftArrow,
  );
  static KeyboardKey subtract = KeyboardKey(
    packetIndex: 1,
    index: 60,
    keyCode: KeyCode.subtract,
  );
  static KeyboardKey num3 = KeyboardKey(
    packetIndex: 1,
    index: 61,
    keyCode: KeyCode.numpad_3,
  );
  static KeyboardKey f10 = KeyboardKey(
    packetIndex: 2,
    index: 4,
    keyCode: KeyCode.f10,
  );
  static KeyboardKey key0 = KeyboardKey(
    packetIndex: 2,
    index: 5,
    keyCode: KeyCode.key0,
  );
  static KeyboardKey p = KeyboardKey(
    packetIndex: 2,
    index: 6,
    keyCode: KeyCode.p,
  );
  static KeyboardKey semicolon = KeyboardKey(
    packetIndex: 2,
    index: 7,
    keyCode: KeyCode.semicolon,
  );
  static KeyboardKey period = KeyboardKey(
    packetIndex: 2,
    index: 8,
    keyCode: KeyCode.period,
  );
  static KeyboardKey enter = KeyboardKey(
    packetIndex: 2,
    index: 10,
    keyCode: KeyCode.enter,
  );
  static KeyboardKey downArrow = KeyboardKey(
    packetIndex: 2,
    index: 11,
    keyCode: KeyCode.downArrow,
  );
  static KeyboardKey add = KeyboardKey(
    packetIndex: 2,
    index: 12,
    keyCode: KeyCode.add,
  );
  static KeyboardKey num0 = KeyboardKey(
    packetIndex: 2,
    index: 13,
    keyCode: KeyCode.numpad_0,
  );
  static KeyboardKey f11 = KeyboardKey(
    packetIndex: 2,
    index: 16,
    keyCode: KeyCode.f11,
  );
  static KeyboardKey minus = KeyboardKey(
    packetIndex: 2,
    index: 17,
    keyCode: KeyCode.minus,
  );
  static KeyboardKey openBracket = KeyboardKey(
    packetIndex: 2,
    index: 18,
    keyCode: KeyCode.openBracket,
  );
  static KeyboardKey quote = KeyboardKey(
    packetIndex: 2,
    index: 19,
    keyCode: KeyCode.quote,
  );
  static KeyboardKey slash = KeyboardKey(
    packetIndex: 2,
    index: 20,
    keyCode: KeyCode.slash,
  );
  static KeyboardKey corsairStar = KeyboardKey(
    packetIndex: 2,
    index: 21,
    keyCode: KeyCode.corsairStar,
  );
  static KeyboardKey rightArrow = KeyboardKey(
    packetIndex: 2,
    index: 23,
    keyCode: KeyCode.rightArrow,
  );
  static KeyboardKey rightEnter = KeyboardKey(
    packetIndex: 2,
    index: 24,
    keyCode: KeyCode.enter,
  );
  static KeyboardKey decimal = KeyboardKey(
    packetIndex: 2,
    index: 25,
    keyCode: KeyCode.decimal,
  );
  static KeyboardKey get emptyKey => KeyboardKey(
    packetIndex: -1,
    index: -1,
    keyCode: KeyCode.unknown,
  );

  static Map<String, KeyboardKey> keys = <String, KeyboardKey>{
    'x0y0': emptyKey,
    'x1y0': emptyKey,
    'x2y0': emptyKey,
    'x3y0': emptyKey,
    'x4y0': emptyKey,
    'x5y0': emptyKey,
    'x6y0': emptyKey,
    'x7y0': emptyKey,
    'x8y0': emptyKey,
    'x9y0': emptyKey,
    'x10y0': emptyKey,
    'x11y0': emptyKey,
    'x12y0': emptyKey,
    'x13y0': emptyKey,
    'x14y0': emptyKey,
    'x15y0': corsairStar,
    'x16y0': emptyKey,
    'x17y0': emptyKey,
    'x18y0': emptyKey,
    'x19y0': mute,
    'x20y0': emptyKey,
    'x21y0': emptyKey,
    'x0y1': esc,
    'x1y1': emptyKey,
    'x2y1': f1,
    'x3y1': f2,
    'x4y1': f3,
    'x5y1': f4,
    'x6y1': f5,
    'x7y1': f6,
    'x8y1': f7,
    'x9y1': f8,
    'x10y1': emptyKey,
    'x11y1': f9,
    'x12y1': f10,
    'x13y1': f11,
    'x14y1': f12,
    'x15y1': printScreen,
    'x16y1': scrollLock,
    'x17y1': pauseBreak,
    'x18y1': pause,
    'x19y1': previous,
    'x20y1': resumeStop,
    'x21y1': next,
    'x0y2': backQuote,
    'x1y2': key1,
    'x2y2': key2,
    'x3y2': key3,
    'x4y2': key4,
    'x5y2': key5,
    'x6y2': key6,
    'x7y2': key7,
    'x8y2': key8,
    'x9y2': key9,
    'x10y2': key0,
    'x11y2': minus,
    'x12y2': equal,
    'x13y2': emptyKey,
    'x14y2': backSpace,
    'x15y2': insert,
    'x16y2': home,
    'x17y2': pageUp,
    'x18y2': numLock,
    'x19y2': divide,
    'x20y2': multiply,
    'x21y2': subtract,
    'x0y3': tab,
    'x1y3': q,
    'x2y3': w,
    'x3y3': e,
    'x4y3': r,
    'x5y3': t,
    'x6y3': y,
    'x7y3': u,
    'x8y3': i,
    'x9y3': o,
    'x10y3': p,
    'x11y3': openBracket,
    'x12y3': closeBracket,
    'x13y3': enter,
    'x14y3': emptyKey,
    'x15y3': delete,
    'x16y3': end,
    'x17y3': pageDown,
    'x18y3': num7,
    'x19y3': num8,
    'x20y3': num9,
    'x21y3': add,
    'x0y4': capsLock,
    'x1y4': a,
    'x2y4': s,
    'x3y4': d,
    'x4y4': f,
    'x5y4': g,
    'x6y4': h,
    'x7y4': j,
    'x8y4': k,
    'x9y4': l,
    'x10y4': semicolon,
    'x11y4': quote,
    'x12y4': backSlash,
    'x13y4': emptyKey,
    'x14y4': emptyKey,
    'x15y4': emptyKey,
    'x16y4': emptyKey,
    'x17y4': emptyKey,
    'x18y4': num4,
    'x19y4': num5,
    'x20y4': num6,
    'x21y4': emptyKey,
    'x0y5': leftShift,
    'x1y5': leftBackSlash,
    'x2y5': z,
    'x3y5': x,
    'x4y5': c,
    'x5y5': v,
    'x6y5': b,
    'x7y5': n,
    'x8y5': m,
    'x9y5': comma,
    'x10y5': period,
    'x11y5': slash,
    'x12y5': emptyKey,
    'x13y5': rightShift,
    'x14y5': emptyKey,
    'x15y5': emptyKey,
    'x16y5': upArrow,
    'x17y5': emptyKey,
    'x18y5': num1,
    'x19y5': num2,
    'x20y5': num3,
    'x21y5': rightEnter,
    'x0y6': leftControl,
    'x1y6': leftWin,
    'x2y6': leftAlt,
    'x3y6': emptyKey,
    'x4y6': emptyKey,
    'x5y6': emptyKey,
    'x6y6': space,
    'x7y6': emptyKey,
    'x8y6': emptyKey,
    'x9y6': emptyKey,
    'x10y6': rightAlt,
    'x11y6': rightWin,
    'x12y6': contextMenu,
    'x13y6': emptyKey,
    'x14y6': rightControl,
    'x15y6': leftArrow,
    'x16y6': downArrow,
    'x17y6': rightArrow,
    'x18y6': num0,
    'x19y6': emptyKey,
    'x20y6': decimal,
    'x21y6': emptyKey,
  };

  static Map<KeyboardKey, String> get reverseKeys {
    if (_reverseKeys.isEmpty) {
      _initReverseKeys();
    }

    return _reverseKeys;
  }

  static Map<KeyboardKey, String> _reverseKeys = {};

  static void _initReverseKeys() {
    _reverseKeys = Map<KeyboardKey, String>.fromEntries(
      keys.entries.map(
        (MapEntry<String, KeyboardKey> entry) => MapEntry<KeyboardKey, String>(
          entry.value,
          entry.key,
        ),
      ),
    );
  }

  static Map<KeyCode, String> get reverseKeyCodes {
    if (_reverseKeyCodes.isEmpty) {
      _initReverseKeyCodes();
    }

    return _reverseKeyCodes;
  }

  static Map<KeyCode, String> _reverseKeyCodes = {};

  static void _initReverseKeyCodes() {
    _reverseKeyCodes = Map<KeyCode, String>.fromEntries(
      keys.entries.map(
            (MapEntry<String, KeyboardKey> entry) => MapEntry<KeyCode, String>(
          entry.value.keyCode,
          entry.key,
        ),
      ),
    );
  }

  static KeyboardKey? getWithOffset({
    required KeyboardKey? keyboardKey,
    int offsetX = 0,
    int offsetY = 0,
  }) {
    String coords = reverseKeys[keyboardKey] ?? '';
    int x = getX(coords);
    int y = getY(coords);
    int newX = x + offsetX;
    int newY = y + offsetY;
    String newCoords = getCoords(newX, newY);

    return keys[newCoords];
  }

  static int getX(String coords) {
    final int yIndex = _getYIndex(coords);
    final String x = coords.substring(1, yIndex);

    return int.parse(x);
  }

  static int getY(String coords) {
    final int yIndex = _getYIndex(coords);
    final String y = coords.substring(yIndex + 1);

    return int.parse(y);
  }

  static int _getYIndex(String coords) {
    return coords.indexOf('y');
  }

  static String getCoords(int x, int y) {
    return 'x${x}y$y';
  }
}
